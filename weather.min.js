$(document).ready(function(){function a(){var a=$("li");$("#user-location").keydown(function(b){var c,e=b.keyCode,f=a.filter(".selected");if(40==e||38==e||13==e)if(a.removeClass("selected"),40==e)c=!f.length||f.is(":last-child")?a.eq(0):f.next(),c.addClass("selected");else if(38==e)c=!f.length||f.is(":first-child")?a.last():f.prev(),c.addClass("selected");else if(13==e){var g=f.children("a").data("url");d(g),$("#user-location").blur()}})}function b(){$("ul#city-list").empty();var b="",c="",d=$("#user-location").val(),e=($("#weather-results"),"http://autocomplete.wunderground.com/aq?query="+d+"&h=0"),f=e+"&cb=?";$.getJSON(f,function(d){$("#json-results").html(JSON.stringify(d,null,1));var e=JSON.stringify(d,null,1);e=JSON.parse(e);for(var f=0;f<e.RESULTS.length;f++)b=e.RESULTS[f].name,c=e.RESULTS[f].l,$("ul#city-list").append('<li value= "'+f+'" > <a href="#" class="filter-city" data-url="'+c+'">'+b+"</a></li>"),$("#results").removeClass("hide-results").addClass("show-results");a(),$("#city-list li").hover(function(){$("#city-list li").removeClass("selected"),$(this).addClass("selected")})})}function c(a){$("#user-location:text").val("")}function d(a){f.show(),$(".weather-results").removeClass("show-results").addClass("hide-results"),$(".weather-block").removeClass("active").addClass("inactive");var b=$(".weather-results"),d="6d21846ad7649b70",e="http://api.wunderground.com/api/"+d+"/conditions/q/"+a+".json";$.ajax({url:e,dataType:"jsonp",success:function(a){var c=a.current_observation.feelslike_f,d=a.current_observation.weather,e=a.current_observation.display_location.full;console.log("weather",d),b.find(".location-results").html(e),b.find(".icon").addClass(g[d]),b.find(".temp-results").html(Math.round(c)),f.hide()}}),c(location),$("ul#city-list").empty(),$(".weather-results").removeClass("hide-results").addClass("show-results"),$("#results").removeClass("show-results").addClass("hide-results")}var e=0,f=$("#pre-loader").hide();$(document).ajaxStart(function(){f.show()}).ajaxStop(function(){f.hide()}),$(".weather-block").each(function(){var a=$(this),b=$(this).data("state"),c=$(this).data("city"),d="6d21846ad7649b70",e="http://api.wunderground.com/api/"+d+"/conditions/q/"+b+"/"+c+".json";console.log(e),$.ajax({url:e,dataType:"jsonp",success:function(b){var c=b.current_observation.display_location.full,d=b.current_observation.feelslike_f,e=b.current_observation.weather;b.current_observation.icon;a.find(".location").html(c),a.find(".temp").html(Math.round(d)),a.find(".desc").html(e),a.find(".icon").addClass(g[e])}})});var g={Drizzle:"icon-rain","Light Drizzle":"icon-rain","Heavey Drizzle":"icon-rain",Rain:"icon-rain","Light Rain":"icon-rain","Heavy Rain":"icon-rain",Snow:"icon-snow","Light Snow":"icon-snow","Heavy Snow":"icon-snow","Light Snow Grains":"icon-snow","Heavy Snow Grains":"icon-snow","Snow Grains":"icon-snow","Light Ice Crystals":"icon-hail","Heavey Ice Crystals":"icon-hail","Ice Crystals":"icon-hail","Light Ice Pellets":"icon-hail","Heavey Ice Pellets":"icon-hail",Pellets:"icon-hail",Mist:"icon-clouds","Light Mist":"icon-clouds","Heavy Mist":"icon-clouds",Fog:"icon-clouds","Light Fog":"icon-clouds","Heavy Fog":"icon-clouds","Fog Patches":"icon-clouds","Light Fog Patches":"icon-clouds","Heavy Fog Patches":"icon-clouds",Smoke:"icon-clouds","Light Smoke":"icon-clouds","Heavy Smoke":"icon-clouds","Volcanic Ash":"icon-clouds","Light Volcanic Ash":"icon-clouds","Heavy Volcanic Ash":"icon-clouds","Wide Spread Dust":"icon-clouds","Light Wide Spread Dust":"icon-clouds","Heavy Wide Spread Dust":"icon-clouds",Sand:"icon-clouds","Light Sand":"icon-clouds","Heavy Sand":"icon-clouds",Haze:"icon-clouds","Light Haze":"icon-clouds","Heavy Haze":"icon-clouds",Spray:"icon-clouds","Light Spray":"icon-clouds","Heavy Spray":"icon-clouds","Dust Whirls":"icon-clouds","Light Dust Whirls":"icon-clouds","Heavy Dust Whirls":"icon-clouds","Sand Storm":"icon-clouds","Light Sand Storm":"icon-clouds","Heavy Sand Storm":"icon-clouds","Low Drifting Snow":"icon-snow","Light Low Drifting Snow":"icon-snow","Heavy Low Drifting Snow":"icon-snow","Low Drifting Widespread Dust":"icon-clouds","Light Low Drifting Widespread Dust":"icon-clouds","Heavy Low Drifting Widespread Dust":"icon-clouds","Low Drifting Sand":"icon-clouds","Light Low Drifting Sand":"icon-clouds","Heavy Low Drifting Sand":"icon-clouds","Blowing Snow":"icon-snow-alt","Light Blowing Snow":"icon-snow-alt","Heavy Blowing Snow":"icon-snow-alt","Blowing Widespread Dust":"icon-clouds","Light Blowing Widespread Dust":"icon-clouds","Heavy Blowing Widespread Dust":"icon-clouds","Blowing Sand":"icon-clouds","Light Blowing Sand":"icon-clouds","Heavy Blowing Sand":"icon-clouds","Rain Mist":"icon-rain","Light Rain Mist":"icon-rain","Heavy Rain Mist":"icon-rain","Rain Showers":"icon-rain","Light Rain Showers":"icon-rain","Heavy Rain Showers":"icon-rain","Snow Showers":"icon-snow","Light Snow Showers":"icon-snow","Heavy Snow Showers":"icon-snow","Snow Blowing Snow Mist":"icon-snow","Light Snow Blowing Snow Mist":"icon-snow","Heavy Snow Blowing Snow Mist":"icon-snow","Ice Pellets Showers":"icon-hail","Light Ice Pellets Showers":"icon-hail","Heavy Ice Pellets Showers":"icon-hail","Ice Pellets Showers":"icon-rain","Light Ice Pellets Showers":"icon-rain","Heavy Ice Pellets Showers":"icon-rain","Hail Showers":"icon-rain","Light Hail Showers":"icon-rain","Heavy Hail Showers":"icon-rain","Small Hail Showers":"icon-rain","Light Small Hail Showers":"icon-rain","Heavy Small Hail Showers":"icon-rain",Thunderstorm:"icon-clouds-flash","Light Thunderstorm":"icon-clouds-flash","Heavy Thunderstorm":"icon-clouds-flash","Thunderstorm and Rain":"icon-clouds-flash","Light Thunderstorm and Rain":"icon-clouds-flash","Heavy Thunderstorm and Rain":"icon-clouds-flash","Thunderstorm and Snow":"icon-clouds-flash","Light Thunderstorm and Snow":"icon-clouds-flash","Heavy Thunderstorm and Snow":"icon-clouds-flash","Thunderstorm and Ice Pellets":"icon-clouds-flash","Light Thunderstorm and Ice Pellets":"icon-clouds-flash","Heavy Thunderstorm and Ice Pellets":"icon-clouds-flash","Thunderstorm and Hail":"icon-clouds-flash","Light Thunderstorm and Hail":"icon-clouds-flash","Heavy Thunderstorm and Hail":"icon-clouds-flash","Freezing Drizzle":"icon-rain","Light Freezing Drizzle":"icon-rain","Heavy Freezing Drizzle":"icon-rain","Freezing Rain":"icon-rain","Light Freezing Rain":"icon-rain","Heavy Freezing Rain":"icon-rain","Freezing Fog":"icon-clouds","Light Freezing Fog":"icon-clouds","Heavy Freezing Fog":"icon-clouds","Patches of Fog":"icon-clouds","Shallow Fog":"icon-clouds","Partial Fog":"icon-cloud-sun",Overcast:"icon-sun","Scattered Clouds":"icon-cloud-sun","Small Hail":"icon-hail","Partly Cloudy":"icon-cloud-sun",Cloudy:"icon-clouds","Chance of Flurries":"icon-snow-alt","Chance of Rain":"icon-rain","Freezing Rain":"icon-hail",Sleet:"icon-hail",Sunny:"icon-sun",Thunderstorms:"icon-clouds-flash-alt",Thunderstorm:"icon-clouds-flash",Unkown:"icon-help-circled-alt","Scattered Clouds":"icon-cloud-sun",Clear:"icon-sun","Mostly Cloudy":"icon-clouds"};$("#city-list").on("click","a",function(a){a.preventDefault();var b=$(this).data("url");d(b)}),$(".show-header").on("click",function(a){a.preventDefault(),$("#search-wrapper").removeClass("inactive").addClass("active"),$(this).removeClass("active").addClass("inactive"),$(".beta-msg").addClass("white-color")}),$(".close-header").on("click",function(a){a.preventDefault(),$(".beta-msg").removeClass("white-color"),$("#user-search").find("input").val(""),$("ul#city-list").empty(),$("#results").removeClass("show-results").addClass("hide-results"),$(".show-header").removeClass("inactive").addClass("active"),$("#search-wrapper").removeClass("active").addClass("inactive")}),$("#user-search").submit(function(a){a.preventDefault()}),$("#user-location").on("keyup",function(){e++;var a=$(this).val();""==a&&($("ul#city-list").empty(),$("#results").removeClass("show-results").addClass("hide-results"),e=0)}),$("#user-location").on("keypress",function(){e>=3&&b()}),$(".close-results").on("click",function(a){a.preventDefault(),$(".weather-results").removeClass("show-results").addClass("hide-results"),$(".weather-block").removeClass("inactive").addClass("active")}),$("#user-location").blur(function(){$("#results").removeClass("show-results").addClass("hide-results")}),$("#user-location:text").focusin(function(){$("#results").removeClass("hide-results").addClass("show-results")})});